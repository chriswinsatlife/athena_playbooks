---
/**
 * SectionChecklist - Renders checklist format content
 * 
 * Displays items as an interactive checklist with checkboxes,
 * optional details, and nested substeps
 */

export interface ChecklistItem {
  label: string;
  details?: string;
  substeps?: string[];
}

export interface Props {
  items: ChecklistItem[];
}

const { items } = Astro.props;
---

<div class="checklist-container">
  <ul class="space-y-4" role="list">
    {items.map((item, index) => (
      <li class="checklist-item group">
        <label class="flex items-start gap-4 cursor-pointer">
          {/* Checkbox */}
          <div class="relative flex-shrink-0 mt-1">
            <input 
              type="checkbox" 
              class="peer sr-only" 
              id={`checklist-${index}`}
            />
            <div class="
              w-5 h-5 rounded border-2 border-zinc-300 bg-white
              flex items-center justify-center
              transition-all duration-150
              peer-checked:bg-[#05240C] peer-checked:border-[#05240C]
              peer-focus-visible:ring-2 peer-focus-visible:ring-offset-2 peer-focus-visible:ring-[#05240C]/50
              group-hover:border-zinc-400
            ">
              <svg 
                class="w-3 h-3 text-white opacity-0 peer-checked:opacity-100 transition-opacity" 
                viewBox="0 0 14 14" 
                fill="none"
              >
                <path 
                  d="M3 8L6 11L11 3.5" 
                  stroke="currentColor" 
                  stroke-width="2" 
                  stroke-linecap="round" 
                  stroke-linejoin="round"
                />
              </svg>
            </div>
          </div>
          
          {/* Content */}
          <div class="flex-1 min-w-0">
            <span class="
              text-base font-medium text-zinc-900 leading-relaxed
              peer-checked:text-zinc-500 peer-checked:line-through
              transition-colors
            ">
              {item.label}
            </span>
            
            {item.details && (
              <p class="mt-1 text-sm text-zinc-500 leading-relaxed">
                {item.details}
              </p>
            )}
            
            {/* Substeps */}
            {item.substeps && item.substeps.length > 0 && (
              <ul class="mt-3 space-y-2 pl-1">
                {item.substeps.map((substep, subIndex) => (
                  <li class="flex items-start gap-3">
                    <label class="flex items-start gap-3 cursor-pointer text-sm">
                      <input 
                        type="checkbox" 
                        class="
                          mt-0.5 w-4 h-4 rounded border-zinc-300 
                          text-[#05240C] 
                          focus:ring-[#05240C]/50 focus:ring-offset-0
                          cursor-pointer
                        " 
                        id={`checklist-${index}-sub-${subIndex}`}
                      />
                      <span class="text-zinc-600">{substep}</span>
                    </label>
                  </li>
                ))}
              </ul>
            )}
          </div>
        </label>
      </li>
    ))}
  </ul>
</div>

<style>
  .checklist-container {
    font-family: 'Figtree', system-ui, -apple-system, sans-serif;
  }
  
  /* Ensure the checkbox styling works with the checked state */
  .checklist-item input[type="checkbox"]:checked + div {
    background-color: #05240C;
    border-color: #05240C;
  }
  
  .checklist-item input[type="checkbox"]:checked + div svg {
    opacity: 1;
  }
  
  .checklist-item input[type="checkbox"]:checked ~ div span:first-child {
    color: #71717a;
    text-decoration: line-through;
  }
  
  /* Substep checkbox styling */
  .checklist-item input[type="checkbox"] {
    accent-color: #05240C;
  }
</style>
